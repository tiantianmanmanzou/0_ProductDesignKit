s

### 1. 前端测试方案 (Vue + TypeScript)

| 测试类型 | 推荐工具/方案 | 测试内容与目的 |
| :--- | :--- | :--- |
| **单元测试** | **[Vitest](https://vitest.dev/)** | - **纯逻辑测试**：专注于测试 `stores` (Pinia) 中的业务逻辑、`utils` 里的工具函数等不直接涉及 UI 渲染的纯 TypeScript/JavaScript 逻辑。<br>- **目的**：确保应用中最基础的逻辑单元正确无误，运行速度快，反馈及时。 |
| **组件测试** | **[Vue Testing Library](https://testing-library.com/docs/vue-testing-library/intro/) + Vitest** | - **组件行为测试**：在模拟的 DOM 环境中独立渲染 Vue 组件，验证其接收 `props` 后的渲染、响应用户交互（如点击、输入）并触发 `events` 的行为是否符合预期。<br>- **目的**：保证构成界面的核心元素功能健壮，这是确保 UI 质量的关键环节。 |

---

### 2. 后端测试方案 (Python/FastAPI)

| 测试类型 | 推荐工具/方案 | 测试内容与目的 |
| :--- | :--- | :--- |
| **单元测试** | **[Pytest](https://docs.pytest.org/)** | - **逻辑单元测试**：针对 `services`, `utils`, `core` 中的单个函数或方法进行隔离测试。<br>- **关键实践**：使用 `unittest.mock` 库来模拟（Mock）数据库、外部 API 等依赖，确保测试的独立性和速度。 |
| **集成测试** | **Pytest + `TestClient`** | - **API 接口测试**：使用 FastAPI 自带的 `TestClient` (基于 HTTPX) 直接对 API 接口进行调用，无需启动真实服务器。测试接口的请求、响应、状态码、数据验证、以及其背后的业务逻辑与数据库交互。<br>- **数据库交互**：连接到一个 **专用的测试数据库** 来验证数据操作的正确性，并利用 Pytest Fixtures 自动化管理测试数据的准备与清理。 |

---

### 3. 前后端端到端 (E2E) 集成测试

这是验证整个应用系统能否作为一个整体顺畅工作的最终保障。

*   **执行工具**：**[Playwright](https://playwright.dev/)** (遵照您的选型)。
*   **测试内容**：模拟真实用户，执行最核心的业务流程（Happy Path），例如：用户登录 -> 创建项目 -> 上传文件 -> 成功解析。
*   **测试环境**：E2E 测试需要在 **一个完整的、隔离的测试环境中运行**。强烈推荐使用 `docker-compose` 来一键启动所有服务（前端、后端、测试数据库），以确保环境的一致性和可复现性。
*   **核心目的**：确保前后端之间的“契约”（API 调用和数据交换）是正确履行的，并且关键的用户旅程没有中断。由于其运行和维护成本较高，应 **严格限制测试用例数量，只覆盖最高价值的场景**。

---

### 4. 测试文件目录规范

一个清晰的目录结构是高效实践以上测试方案的基础。

```
Excel2Doc/
├── backend/
│   ├── app/
│   │   └── ... (源代码)
│   └── tests/                  # ⬅️ 所有后端测试
│       ├── integration/
│       │   └── test_projects_api.py  # 后端集成测试 (API测试)
│       └── unit/
│           └── test_project_service.py # 后端单元测试
│
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   ├── business/
│   │   │   │   ├── FileParseProgress.vue
│   │   │   │   └── FileParseProgress.spec.ts  # ⬅️ 组件测试紧随组件
│   │   │   └── ...
│   │   ├── stores/
│   │   │   ├── project.ts
│   │   │   └── project.spec.ts              # ⬅️ Store单元测试紧随源文件
│   │   └── ...
│   └── tests/                  # 前后端集成测试目录
│       ├── fixtures/           # 测试数据文件
│       │   └── test-excel.xlsx
│       ├── utils/              # 测试工具函数
│       │   └── test-helpers.ts
│       ├── page-objects/       # 页面对象模型
│       │   └── project-page.ts
│       ├── basic/              # 基础功能测试
│       │   └── user-auth.spec.ts
│       ├── integration/        # 集成测试
│       │   └── project-creation.spec.ts
│       ├── e2e/                # 端到端测试
│       │   └── project-management.spec.ts
│       └── debug/              # 调试测试
│           └── debug-project-creation.spec.ts

```

**规范说明：**

1.  **后端 (`backend/tests`)**：明确划分为 `unit` 和 `integration` 子目录，职责清晰。
2.  **前端单元/组件测试**：遵循“就近原则”，测试文件 (`.spec.ts`) 与其对应的源文件（`.vue`, `.ts`）放在同一目录下。这使得在开发或重构组件时，能非常方便地找到并更新其测试。
3.  **前端后端 E2E 集成测试 (`frontend/tests/e2e`)**：E2E 测试跨越多个组件和页面，将其统一存放在 `frontend/tests/e2e` 目录下，按业务模块组织文件，更易于管理。